<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="/images/cabin.png" >
    <link href="/styles/main.css" rel="stylesheet">
    
    <title>Integralist -> BBC News Engineer</title>
    
    
    <link rel="alternate" type="application/atom+xml" title="Integralist" href="http://feeds.feedburner.com/Integralist">
  </head>
  <body>
    <nav>
      <h1 class="name">
          <a href="/">Integralist</a> <span class="role">BBC News Engineer</span>
      </h1>
      <div class="menu icon-menu"></div>
      <ul class="nav-links">
        <li class="text-link">
          <a href="/about.html">about</a>
        </li>
        <li class="text-link">
          <a href="/projects.html">projects</a>
        </li>
        <li class="text-link">
          <a href="/archives.html">archives</a>
        </li>
      </ul>
      <div class="social-media">
        <a href="https://github.com/integralist" class="icon-github"></a>
        <a href="https://twitter.com/integralist" class="icon-twitter"></a>
      </div>
    </nav>
    <div class="content">


  <div class="post-head group">
  <a href="/posts/regex-popup-window/">
    <h1 class="post-title">Regex Popup Window</h1>
  </a>
  <span class="post-date">2012 &#183; 1 &#183; 1</span>
</div>

<div class="post-body"><h2><a name="what-well-cover" class="anchor" href="#what-well-cover"><span class="header-link"></span></a>What we&#39;ll cover</h2>
<p><em>reading time: approx. 4mins</em></p>
<ul>
<li>Introduction</li>
<li>The (original) Regex Solution</li>
<li>Example Code</li>
<li>Update 1</li>
<li>Update 2</li>
</ul>
<h2><a name="introduction" class="anchor" href="#introduction"><span class="header-link"></span></a>Introduction</h2>
<p>This is a quick post to show you how to open up external website links within a pop-up window (without adding extra non semantic mark-up to your HTML code).</p>
<p>In the past I’ve heard a lot of people talk about adding either custom attributes or using existing attributes such as <code>rel</code> as a hook for your JavaScript code to find links that should open in a pop-up window. I disagree, and suggest using Regular Expressions (regexes) along with some procedural code to help figure this out for you (it will save you the time and hassle of adding this extra mark-up yourself).</p>
<p>This solution is an updated version. The previous version was recklessly using <a href="http://www.regular-expressions.info/brackets.html">capture groups</a> when really they should have been using non-capturing groups (as the brackets in the following solution are solely for applying <a href="http://www.regular-expressions.info/repeat.html">quantifiers</a> and <a href="http://www.regular-expressions.info/optional.html">optional items</a>). The reason you should use capturing groups sparingly is to do with performance and saving the regex engine from having to remember content within the capturing groups. The Regular Expression checks for things like whether the URL is an SSL protected URL and uses a <a href="http://www.regular-expressions.info/lookaround.html">negative look ahead assertion</a> to make sure that it doesn’t incorrectly match URL’s that <em>appear</em> to be external (e.g. they start with a http) but in fact actually are links to the current website URL (this happens a lot with Content Management Systems where a user will copy and paste the full URL to one of their own pages).</p>
<h2><a name="the-original-regex-solution" class="anchor" href="#the-original-regex-solution"><span class="header-link"></span></a>The (original) Regex Solution</h2>
<p><code>^http(?:s)?:\/\/(?!(?:www.)?integralist)</code></p>
<h2><a name="example-code" class="anchor" href="#example-code"><span class="header-link"></span></a>Example Code</h2>
<pre><code class="lang-js"><div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * The Integralist global namespace object.</span>
<span class="cm"> *</span>
<span class="cm"> * @class Integralist</span>
<span class="cm"> * @singleton</span>
<span class="cm"> * @static</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">Integralist</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Constructor</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Augment the Integralist class so it includes a method</span>
<span class="cm"> * which finds all &lt;a&gt; elements that link to an external website</span>
<span class="cm"> * and sets them to open in a popup window</span>
<span class="cm"> */</span>
<span class="nx">Integralist</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">external</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// Required to keep scope within the following Closure</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="s1">&#39;location=yes,resizable=yes,width=&#39;</span> <span class="o">+</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">availWidth</span> <span class="o">+</span> <span class="s1">&#39;,height=&#39;</span> <span class="o">+</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">availHeight</span> <span class="o">+</span> <span class="s1">&#39;,scrollbars=1,left=0,top=0&#39;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">popup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
        <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="s1">&#39;external&#39;</span> <span class="p">,</span> <span class="nx">that</span><span class="p">.</span><span class="nx">settings</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="c1">// Private variable to store HTMLCollection of all &lt;a&gt; elements</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="c1">// Store array length in variable</span>
        <span class="nx">pattern</span> <span class="o">=</span> <span class="sr">/^http(?:s)?:\/\/(?!(?:www.)?integralist)/</span><span class="p">;</span> <span class="c1">// RegExp pattern to match any external URL&#39;s but not the current website</span>

    <span class="c1">// Loop through the array checking for any A elements that link to an external URL</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">len</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="nx">a</span><span class="p">[</span><span class="nx">len</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">pattern</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">element</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">a</span><span class="p">[</span><span class="nx">len</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">popup</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">len</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Create a singleton of the Integralist Class</span>
<span class="kd">var</span> <span class="nx">Integralist</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Integralist</span><span class="p">();</span>

<span class="c1">// Trigger &#39;external&#39; method</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">Integralist</span><span class="p">.</span><span class="nx">external</span><span class="p">;</span>
</pre></div>
</code></pre>
<h2><a name="update-1" class="anchor" href="#update-1"><span class="header-link"></span></a>Update 1</h2>
<p>Tweaked the regex again to make it simpler. Decided using a character class for just a single dot character was pointless, might as well just escape the dot. Also got rid of the non-capturing group around the s in https and just used an optional token <code>?</code> on its own as again it was pointless wrapping a single character in a non-capturing group.</p>
<p><code>^https?:\/\/(?!(?:www\.)?integralist)</code></p>
<h2><a name="update-2" class="anchor" href="#update-2"><span class="header-link"></span></a>Update 2</h2>
<p>I’ve ended up tweaking the regex again to take into account files that don’t start with http but should still open in a pop-up window. For example if a website links to a self hosted PDF file it might store it in the following directory path <code>Assets/Documents/MyFile.pdf</code>. First thing I did was add a case-insensitive modifier flag (which I simply forgot last time). Now to work around the issue of linking to internal documents that should open in a pop-up I place a non-capturing group after the opening anchor <code>^</code>. Within this group it has a character class that allows a period <code>.</code> and a forward slash <code>/</code> and uses a quantifier <code>+</code> so it matches 1 or more times. I then make the whole group optional. Next, we take the original regex and wrap it in a non-capturing group and place it after the preceding code. Inside the non-capturing group, at the start we add the name of the directory we are looking for (in this case I just need to look for the word “Assets” and I know it’s going to link to a document and not a HTML file). I then put in the alternator meta-character so it will look for “Assets” and if it can’t find it the regex engine will backtrack to this point and try the rest of the regex which we’ve already discussed. So the final regex looks like this…</p>
<p><code>^(?:[.\/]+)?(?:Assets|https?:\/\/(?!(?:www\.)?integralist))</code></p>
</div>

  <div class="comments">
    <a href="/posts/regex-popup-window/#comments">
      <span class="icon-bubbles"></span>
      Comments
    </a>
  </div>

  <div class="post-head group">
  <a href="/posts/javascript-inheritance/">
    <h1 class="post-title">JavaScript Inheritance</h1>
  </a>
  <span class="post-date">2012 &#183; 1 &#183; 1</span>
</div>

<div class="post-body"><h2><a name="what-well-cover" class="anchor" href="#what-well-cover"><span class="header-link"></span></a>What we&#39;ll cover</h2>
<p><em>reading time: approx. 2mins</em></p>
<ul>
<li>Introduction</li>
<li>Constructors</li>
<li>Example Code</li>
<li>Conclusion</li>
</ul>
<h2><a name="introduction" class="anchor" href="#introduction"><span class="header-link"></span></a>Introduction</h2>
<p><a href="http://en.wikipedia.org/wiki/Class_(object-oriented_programming\">Class based inheritance</a>) doesn’t exist in JavaScript (<em>note: ECMAScript had plans to implement in ES6 basic Class syntax, but as of April 2012 this seems to be in doubt again</em>), but you can replicate its syntax by using functions as Constructors.</p>
<h2><a name="constructors" class="anchor" href="#constructors"><span class="header-link"></span></a>Constructors</h2>
<p>The basic premise to have code that appears more <code>Class</code> like is this: JavaScript functions created using the <code>new</code> keyword work in a similar way to what Class based languages refer to as ‘Constructors’. When a function uses the <code>new</code> keyword the Function object is given a <code>prototype</code> property which points (initially) to an empty object. This empty object can then have methods and properties added to it which will be available to all other objects that point their own prototype link to it.</p>
<h2><a name="example-code" class="anchor" href="#example-code"><span class="header-link"></span></a>Example Code</h2>
<p>A basic example is as follows…</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span> <span class="nx">settings</span> <span class="o">=</span> <span class="p">{};</span> <span class="p">}</span> <span class="c1">// code defensively</span>

   <span class="c1">// Instance properties (any new instances of the Person class will have these properties)</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="s1">&#39;no name given&#39;</span><span class="p">;</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">age</span> <span class="o">||</span> <span class="s1">&#39;no age given&#39;</span><span class="p">;</span>

   <span class="c1">// Instance method (any new instances of the Person class will have this method)</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
   <span class="p">};</span>
<span class="p">};</span>

<span class="c1">// Create a new instance of the Person Class</span>
<span class="kd">var</span> <span class="nx">integralist</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;Mark&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span><span class="mi">7</span> <span class="p">});</span>

<span class="c1">// Add a method to this instance of the Person Class only (no other instances created will have this method)</span>
<span class="nx">integralist</span><span class="p">.</span><span class="nx">getAge</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Test the integralist instance has access to both methods</span>
<span class="nx">integralist</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>
<span class="nx">integralist</span><span class="p">.</span><span class="nx">getAge</span><span class="p">();</span>

<span class="c1">// Create another instance of the Person Class</span>
<span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>

<span class="c1">// Notice the user has access to a &#39;getName&#39; method but not a &#39;getAge&#39; method</span>
<span class="nx">user</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>

<span class="c1">// I know this will error so I&#39;m wrapping it in a try statement</span>
<span class="k">try</span> <span class="p">{</span>
   <span class="nx">user</span><span class="p">.</span><span class="nx">getAge</span><span class="p">();</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">alert</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="c1">// Uncaught TypeError: Object [object Object] has no method &#39;getAge&#39;</span>
<span class="p">}</span>

<span class="c1">// Add a method to the Person Class&#39; prototype chain (all instances of the Person Class will now get this method - even those already defined)</span>
<span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getNameAndAge</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hi, my name is &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;, and I\&#39;m &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">+</span> <span class="s1">&#39; years old.&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Test this new method is accessible to all instances of the Person Class</span>
<span class="nx">integralist</span><span class="p">.</span><span class="nx">getNameAndAge</span><span class="p">();</span>
<span class="nx">user</span><span class="p">.</span><span class="nx">getNameAndAge</span><span class="p">();</span>
</pre></div>
</code></pre>
<h2><a name="conclusion" class="anchor" href="#conclusion"><span class="header-link"></span></a>Conclusion</h2>
<p>Personally I would suggest you learn how JavaScript implements its own form of inheritance (prototypal inheritance) which is more efficient and nicer to work with than the use of functions as Constructors.</p>
<p>The Mozilla Developer Network has written up a short article on the differences between Class-based and Prototype-based languages which you can find here: <a href="https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Details_of_the_Object_Model#Class-Based_vs._Prototype-Based_Languages"><a href="https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Details_of_the_Object_Model#Class-Based_vs._Prototype-Based_Languages">https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Details_of_the_Object_Model#Class-Based_vs._Prototype-Based_Languages</a></a></p>
</div>

  <div class="comments">
    <a href="/posts/javascript-inheritance/#comments">
      <span class="icon-bubbles"></span>
      Comments
    </a>
  </div>


<div class="pagination group">
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
      <a href="/page/15/" class="newer"> Newer &#8594;</a>
    
  
    
    
  
</div>
    </div>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js" type="text/javascript"></script>
    <script src="/scripts/main.js" type="text/javascript"></script>
    <script src="/scripts/Imager.js" type="text/javascript"></script>
    <script>
        var _gaq=[['_setAccount','UA-33159515-1'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
  </body>
</html>

